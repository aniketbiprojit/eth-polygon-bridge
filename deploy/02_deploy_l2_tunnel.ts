import { DeployFunction } from 'hardhat-deploy/dist/types'

const func: DeployFunction = async (hre) => {
	const { deployments, getNamedAccounts } = hre
	const { deploy, execute } = deployments
	const { deployer } = await getNamedAccounts()

	const FxChildAddress = (await deployments.get('FxChild')).address

	await deploy('L2Tunnel', {
		from: deployer,
		log: true,
		skipIfAlreadyDeployed: true,
		args: [FxChildAddress],
	})

	// await execute(
	// 	'L2Tunnel',
	// 	{ from: deployer },
	// 	'setFxRootTunnel',
	// 	(
	// 		await hre.companionNetworks['l1'].deployments.get('L1Tunnel')
	// 	).address
	// )

	// await hre.companionNetworks['l1'].deployments.execute(
	// 	'L1Tunnel',
	// 	{
	// 		from: deployer,
	// 	},
	// 	'setFxChildTunnel',
	// 	(
	// 		await deployments.get('L2Tunnel')
	// 	).address
	// )
	// return
	await execute(
		'L2Tunnel',
		{ from: deployer, log: true },
		'sendMessageToRoot',
		'0x0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000150000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000046e616d6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000576616c7565000000000000000000000000000000000000000000000000000000'
	)
	await execute(
		'L2Tunnel',
		{ from: deployer, log: true },
		'sendMessageToRoot',
		'0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000150000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000046e616d6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000576616c7565000000000000000000000000000000000000000000000000000000'
	)
	await execute(
		'L2Tunnel',
		{ from: deployer, log: true },
		'sendEncodedMessageToRoot'
	)
	await execute(
		'L2Tunnel',
		{ from: deployer, log: true },
		'sendEncodedBytesMessageToRoot'
	)
}

export default func
func.dependencies = []
func.tags = ['L2Tunnel']
